<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<!--[if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script><![endif]-->
	<title></title>
	<meta name="keywords" content="" />
	<meta name="description" content="" />
	<link href="css/pagestyle.css" rel="stylesheet">
	<link href="css/gamestyle.css" rel="stylesheet">
  <link href="css/tablestyle.css" rel="stylesheet">

</head>
<!--<canvas id="GameBoardCanvas"  width="400" height="400"></canvas> -->

<script type="text/javascript">
    function loadCanvas(id) {
        var canvas = document.createElement('canvas'),
        div = document.getElementById(id);
        canvas.id     = "GameBoardCanvas";
        canvas.width  = 400;
        canvas.height = 400;
        canvas.style.zIndex   = 8;
				canvas.border= "#FF0000"
				canvas.lineWidth = 2;
	canvas.strokeStyle="#FF0000";
//	canvas.strokeRect(0, 0, canvas.width, canvas.height);
				canvas.padding="5px";
				canvas.marginLeft= "auto";
			canvas.marginRight="auto";

        canvas.style.position = "absolute";
        canvas.style.border   = "2px solid red";
        div.appendChild(canvas);
    }

		/* ... */
		 function LoadContent()
		 {
    	loadCanvas("contentDiv");
		}

</script>

  <script type="text/javascript">
    function loadScript(url, callback)
    {
      // Adding the script tag to the head as suggested before
      var head = document.getElementsByTagName('head')[0];
      var script = document.createElement('script');
      script.type = 'text/javascript';
      script.src = url;

      // Then bind the event to the callback function.
      // There are several events for cross browser compatibility.
      script.onreadystatechange = callback;
      script.onload = callback;

      // Fire the loading
      document.head.appendChild(script);
    }

    var doneLoading = function()
    {
        console.log("ETHInteractions loaded");
    };

    loadScript("js/ETHinteractions.js", doneLoading);
  </script>

<script type= "text/javascript" src="js/ContractABI.js"></script>

<script type="text/javascript">


var el = function(id){ return document.querySelector(id); };

//The game board 1 = walls, 0 = free space, and -1 = the goal
var board = [
    [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [ 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
    [ 1, 0, 1, 0, 0, 0, 0, 0, 1, 0],
    [ 0, 0, 0, 0, 1, 1, 1, 0, 1, 0],
    [ 0, 1, 1, 0, 0, 0, 1, 0, 1, 0],
    [ 0, 0, 1, 1, 1, 1, 1, 0, 1, 0],
    [ 1, 0, 1, 0, 0, 0, 1, 0, 1, 0],
    [ 1, 0, 1, 0, 1, 0, 1, 0, 0, 0],
    [ 1, 0, 1, 0, 1, 0, 0, 1, 1, 0],
    [-1, 0, 1, 0, 1, 1, 0, 0, 0, 0]
];

var player = {
    x: 0,
    y: 0
};

//Draw the game board
function draw()
{
	var canvas = document.getElementById("GameBoardCanvas");
    var width = canvas.width;
    var blockSize = width/board.length;
    var ctx = canvas.getContext('2d');
    ctx.setTransform(1, 0, 0, 1, 0, 0);
    ctx.clearRect(0, 0, width, width);
    ctx.fillStyle="white";
    //Loop through the board array drawing the walls and the goal
    for(var y = 0; y < board.length; y++)
    {
        for(var x = 0; x < board[y].length; x++)
        {
            //Draw a wall
            if(board[y][x] === 1){
                ctx.fillRect(x*blockSize, y*blockSize, blockSize, blockSize);
            }
            //Draw the goal
            else if(board[y][x] === -1){
                ctx.beginPath();
                ctx.lineWidth = 5;
                ctx.strokeStyle = "gold";
                ctx.moveTo(x*blockSize, y*blockSize);
                ctx.lineTo((x+1)*blockSize, (y+1)*blockSize);
                ctx.moveTo(x*blockSize, (y+1)*blockSize);
                ctx.lineTo((x+1)*blockSize, y*blockSize);
                ctx.stroke();
            }
        }
    }
    //Draw the player
    ctx.beginPath();
    var half = blockSize/2;
    ctx.fillStyle = "blue";
    ctx.arc(player.x*blockSize+half, player.y*blockSize+half, half, 0, 2*Math.PI);
    if (el('#R_X') != null )
      el('#R_X').innerHTML ="0";
    if (el('#R_Y') != null )
      el('#R_Y').innerHTML ="0";
    if (el('#L_X') != null )
      el('#L_X').innerHTML = player.x;
    if (el('#L_Y') != null )
      el('#L_Y').innerHTML = player.y;
    ctx.fill();
}

//Check to see if the new space is inside the board and not a wall
function canMove(x, y)
{
    return (y>=0) && (y<board.length) && (x >= 0) && (x < board[y].length) && (board[y][x] != 1);
}

function KeyUp(e)
{
    if((e.which == 38) && canMove(player.x, player.y-1))//Up arrow
    {
      player.y--;
      SetupBuyButton(player.x,player.y);
    }
    else if((e.which == 40) && canMove(player.x, player.y+1)) // down arrow
    {    player.y++;
        SetupBuyButton(player.x,player.y);
    }
    else if((e.which == 37) && canMove(player.x-1, player.y))
    {    player.x--;
        SetupBuyButton(player.x,player.y);
    }
    else if((e.which == 39) && canMove(player.x+1, player.y))
    {    player.x++;
        SetupBuyButton(player.x,player.y);
    }
    draw();

    e.preventDefault();
}
document.addEventListener("keyup",KeyUp);

//draw();


var assert = function(condition, message) {
    if (!condition)
        throw Error("Assert failed" + (typeof message !== "undefined" ? ": " + message : ""));
};

assert(1===1);

function isNum(data)
{/*
  if (typeof(data !==  “number”))
  return false;
	return !isNaN(parseFloat(data)) && typeof data !== 'string';
  */
  return !isNaN(data);
}

function SetBuyButtonStatus(st)
{
    document.getElementById("BuyButton").disabled = !st;
    console.log("Setting buy button status to ", st);
}
function SetupBuyButton(x,y)
{
  console.log("Testing to see if location ", x,y, "is free");
  if (isAvailable(x,y,SetBuyButtonStatus));
  GetPlotPrice(function(a){
    document.getElementById("BuyButton").innerHTML = "Buy (" + a + " Eth)";
  });
}
function myBuyFunction( )
{
  var x = player.x;
  var y = player.y;
  if(!isNum(x))
    console.error('X -oops not a number');
  if(!isNum(y))
    console.error('y -oops not a number');

  console.log("Buying ",x ,", ", y );
  isAvailable(x,y,MintPlot(x,y));
  console.log("Buy End!");

}
function GetPriceforNewPlot()
{

}
function GetPriceforSaving()
{

}

function mySaveFunction()
{
    console.log("Save!");
}
</script>

<body>

<div class="wrapper">

	<header class="header">
		<strong>Header:</strong> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Cras tortor. Praesent dictum, libero ut tempus dictum, neque eros elementum mauris, quis mollis arcu velit ac diam. Etiam neque. Quisque nec turpis. Aliquam arcu nulla, dictum et, lacinia a, mollis in, ante. Sed eu felis in elit tempor venenatis. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Ut ultricies porttitor purus. Proin non tellus at ligula fringilla tristique. Fusce vehicula quam. Curabitur vel tortor vitae pede imperdiet ultrices. Sed tortor.
	</header><!-- .header-->

	<div class="middle">

		<div class="container" id="contentDiv" >
			<script type="text/javascript">
   			LoadContent();
				draw();
			</script>
			<main class="content">
				<strong>Content:</strong> Sed pinar pede. Donec vel elit.Sed placerat accumsan ligula. Aliquam felis magna, congue quis, tempus eu, aliquam vitae, ante. Cras neque justo, ultrices at, rhoncus a, facilisis eget, nisl. Quisque vitae pede. Nam et augue. Sed a elit. Ut vel massa. Suspendisse nibh pede, ultrices vitae, ultrices nec, mollis non, nibh. In sit amet pede quis leo vulputate hendrerit. Cras laoreet leo et justo auctor condimentum. Integer id enim. Suspendisse egestas, dui ac egestas mollis, libero orci hendrerit lacus, et malesuada lorem neque ac libero. Morbi tempor pulvinar pede. Donec vel elit.Sed placerat accumsan ligula. Aliquam felis magna, congue quis, tempus eu, aliquam vitae, ante. Cras neque justo, ultrices at, rhoncus a, facilisis eget, nisl. Quisque vitae pede. Nam et augue. Sed a elit. Ut vel massa. Suspendisse nibh pede, ultrices vitae, ultrices nec, mollis non, nibh. In sit amet pede quis leo vulputate hendrerit. Cras laoreet leo et justo auctor condimentum. Integer id enim. Suspendisse egestas, dui ac egestas mollis, libero orci hendrerit lacus, et malesuada lorem neque ac libero. Morbi tempor pulvinar pede. Donec vel elit.Sed placerat accumsan ligula. Aliquam felis magna, congue quis, tempus eu, aliquam vitae, ante. Cras neque justo, ultrices at, rhoncus a, facilisis eget, nisl. Quisque vitae pede. Nam et augue. Sed a elit. Ut vel massa. Suspendisse nibh pede, ultrices vitae, ultrices nec, mollis non, nibh. In sit amet pede quis leo vulputate hendrerit. Cras laoreet leo et justo auctor condimentum. Integer id enim. Suspendisse egestas, dui ac egestas mollis, libero orci hendrerit lacus, et malesuada lorem neque ac libero. Morbi tempor pulvinar pede. Donec vel elit.Sed placerat accumsan ligula. Aliquam felis magna, congue quis, tempus eu, aliquam vitae, ante. Cras neque justo, ultrices at, rhoncus a, facilisis eget, nisl. Quisque vitae pede. Nam et augue. Sed a elit. Ut vel massa. Suspendisse nibh pede, ultrices vitae, ultrices nec, mollis non, nibh. In sit amet pede quis leo vulputate hendrerit. Cras laoreet leo et justo auctor condimentum. Integer id enim. Suspendisse egestas, dui ac egestas mollis, libero orci hendrerit lacus, et malesuada lorem neque ac libero. Morbi tempor pulvinar pede. Donec vel elit.
			</main><!-- .content -->
		</div><!-- .container-->

		<aside class="right-sidebar">
			<strong>Right Sidebar:</strong> Integer velit. Vestibulum nisi nunc, accumsan ut, vehicula sit amet, porta a, mi. Nam nisl tellus, placerat eget, posuere eget, egestas eget, dui. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. In elementum urna a eros. Integer iaculis. Maecenas vel elit.
		</aside><!-- .right-sidebar -->

	</div><!-- .middle-->

	<footer class="footer">
		<strong>Footer:</strong> Mus elit Morbi mus enim lacus at quis Nam eget morbi. Et semper urna urna non at cursus dolor vestibulum neque enim. Tellus interdum at laoreet laoreet lacinia lacinia sed Quisque justo quis. Hendrerit scelerisque lorem elit orci tempor tincidunt enim Phasellus dignissim tincidunt. Nunc vel et Sed nisl Vestibulum odio montes Aliquam volutpat pellentesque. Ut pede sagittis et quis nunc gravida porttitor ligula.

		<div class="divTable darkTable">
		<div class="divTableHeading">
		<div class="divTableRow">
		<div class="divTableHead"></div>
		<div class="divTableHead">X Position</div>
		<div class="divTableHead">Y Position</div>
		<div class="divTableHead"></div>
		</div>
		</div>
		<div class="divTableBody">
		<div class="divTableRow">
		<div class="divTableCell">Region</div>
		<div class="divTableCell"  id="R_X">0</div>
		<div class="divTableCell" id="R_Y">0</div>
		<div class="divTableCell">
		  <button type="button" id="BuyButton" onclick="myBuyFunction()">Buy</button><br>
		  <button type="button" onclick="mySaveFunction()" >Save</button>
		</div></div>
		<div class="divTableRow">
		<div class="divTableCell">Local</div><div class="divTableCell" id="L_X">0</div>
		<div class="divTableCell" id="L_Y">0</div><div class="divTableCell">
		  <button type="button">Set</button></div></div>
		</div>

		</div>
		</div>
		</div>
		</div>


	</footer><!-- .footer -->

</div><!-- .wrapper -->


</body>
</html>
